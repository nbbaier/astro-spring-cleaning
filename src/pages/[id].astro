---
import { getCollection, render } from "astro:content";
// 1. Generate a new path for every collection entry
export async function getStaticPaths() {
   const posts = await getCollection("days");
   return posts.map((post) => ({
      params: { id: post.id },
      props: { post },
   }));
}
// 2. For your template, you can get the entry directly from the prop
const { post } = Astro.props;
const { Content } = await render(post);

import Prose from "../components/Prose.astro";
import Layout from "../layouts/Layout.astro";

// Get all posts for navigation
const allPosts = await getCollection("days");
const sortedPosts = allPosts.sort((a, b) => a.id.localeCompare(b.id));
const currentIndex = sortedPosts.findIndex((p) => p.id === post.id);
const prevPost = currentIndex > 0 ? sortedPosts[currentIndex - 1] : null;
const nextPost =
   currentIndex < sortedPosts.length - 1 ? sortedPosts[currentIndex + 1] : null;
---

<Layout title={post.data.title.split(": ")[1].trim()}>
   <h1>{post.data.title}</h1>

   <div class="flex gap-2 mb-6">
      <a
         href="/"
         class="px-4 py-2 bg-gray-200 hover:bg-gray-300 rounded text-black no-underline flex items-center gap-2"
      >
         <span class="text-lg">üè†</span>
         <span class="hidden sm:inline">Home</span>
      </a>
      {
         prevPost && (
            <a
               href={`/${prevPost.id}`}
               class="px-4 py-2 bg-blue-200 hover:bg-blue-300 rounded text-black no-underline flex items-center gap-2"
            >
               <span class="text-lg">‚Üê</span>
               <span class="hidden sm:inline">Previous Day</span>
            </a>
         )
      }
      {
         nextPost && (
            <a
               href={`/${nextPost.id}`}
               class="px-4 py-2 bg-green-200 hover:bg-green-300 rounded text-black no-underline flex items-center gap-2"
            >
               <span class="text-lg">‚Üí</span>
               <span class="hidden sm:inline">Next Day</span>
            </a>
         )
      }
   </div>

   <Content />
</Layout>
